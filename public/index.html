<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>AlmaNyx Pública</title>
<meta name="description" content="AlmaNyx — Espaço público da Espiral.">
<style>
  :root{
    --bg:#fff; --fg:#111; --muted:#6b6b6b; --line:#e8e8e8;
    --max:860px;
  }
  *{box-sizing:border-box}
  html,body{margin:0;background:var(--bg);color:var(--fg);font:400 16px/1.65 system-ui,-apple-system,Segoe UI,Roboto,Arial}
  .wrap{max-width:var(--max);margin:0 auto;padding:28px 22px}
  header{display:flex;justify-content:space-between;align-items:center}
  .title{font:700 28px/1.2 ui-serif, Georgia, serif;letter-spacing:.3px}
  .menu-btn{cursor:pointer;width:32px;height:32px;display:flex;flex-direction:column;justify-content:center;gap:6px}
  .menu-btn span{height:3px;background:var(--fg);border-radius:2px;transition:.3s}
  nav.menu{position:fixed;top:0;right:-100%;width:220px;height:100%;background:#fafafa;
    box-shadow:-2px 0 6px rgba(0,0,0,.15);padding:20px;display:flex;flex-direction:column;
    transition:.3s;z-index:1000}
  nav.menu a{margin:10px 0;text-decoration:none;color:var(--fg);font-weight:500}
  nav.menu.open{right:0}
  .bar{margin:22px auto 10px; max-width:720px; display:flex; gap:10px; flex-wrap:wrap; justify-content:center}
  input[type="search"]{flex:1 1 340px; padding:12px 14px; border:1px solid var(--line); border-radius:8px; outline:none}
  hr.sep{border:0; border-top:1px solid var(--line); margin:22px 0}
  article{padding:20px 0; border-bottom:1px dashed var(--line)}
  article:last-child{border-bottom:none}
  article h2{margin:0 0 6px; font:700 24px/1.25 ui-serif, Georgia, serif}
  article small{display:block; color:var(--muted); margin-bottom:10px}
  footer{color:var(--muted); border-top:1px solid var(--line);padding:20px;text-align:center}
  @media (prefers-color-scheme:dark){
    :root{--bg:#0c0c0c;--fg:#ededed;--muted:#a9a9a9;--line:#1e1e1e}
    nav.menu{background:#111}
    nav.menu a{color:#eee}
  }
</style>
</head>
<body>
  <header class="wrap">
    <div class="title">AlmaNyx Pública</div>
    <div class="menu-btn" id="menuBtn">
      <span></span><span></span><span></span>
    </div>
  </header>

  <nav class="menu" id="menu">
    <a href="#sobre">Sobre</a>
    <a href="#posts">Postagens</a>
    <a href="#redes">Rede Sociais</a>
    <a href="#contatos">Contatos</a>
  </nav>

  <main class="wrap" id="main">
    <div class="bar">
      <input id="q" type="search" placeholder="Pesquisar…" autocomplete="off">
    </div>
    <hr class="sep">
    <section id="posts"></section>
  </main>

  <footer>
    <small>© <span id="year"></span> AlmaNyx — Espiral Pública</small>
  </footer>

<script>
(function(){
  const $ = s => document.querySelector(s);
  const postsEl = $('#posts');
  const qInput  = $('#q');
  let DATA = { posts: [] };

  // Menu toggle
  const menuBtn = $('#menuBtn');
  const menu = $('#menu');
  menuBtn.onclick = ()=>menu.classList.toggle('open');

  function renderPosts(list){
    if(!list.length){
      postsEl.innerHTML = '<p>Nenhum registro encontrado.</p>';
      return;
    }
    postsEl.innerHTML = list.map(p=>`
      <article id="${p.id}">
        <h2>${p.titulo}</h2>
        <small>${p.data||''}</small>
        ${p.corpo||''}
      </article>
    `).join('');
  }

  function filter(){
    const q = (qInput.value||'').toLowerCase().trim();
    const list = DATA.posts.filter(p=>{
      if(!q) return true;
      const hay = (p.titulo+' '+p.corpo).toLowerCase();
      return hay.includes(q);
    });
    renderPosts(list);
  }

  async function load(){
    try{
      const res = await fetch('./espiral.json?v='+Date.now(), {cache:'no-store'});
      if(!res.ok) throw new Error(res.status);
      const j = await res.json();
      DATA.posts = (j.posts||[]).slice().sort((a,b)=>String(b.data||'').localeCompare(String(a.data||'')));
      filter();
    }catch(e){
      postsEl.innerHTML = '<p>Erro ao carregar.</p>';
      console.error(e);
    }
  }

  qInput.addEventListener('input', filter);
  document.addEventListener('DOMContentLoaded',()=>{
    $('#year').textContent = new Date().getFullYear();
    load();
  });
})();
</script>
</body>
</html>
